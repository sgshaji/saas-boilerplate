name: E2E Tests

on: [push, pull_request]

jobs:
  e2e:
    runs-on: ubuntu-latest
    services:
      web:
        image: node:18
        ports: ['3000:3000']
        options: >-
          --health-cmd="curl --fail http://localhost:3000 || exit 1"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=5
        env:
          NODE_ENV: development

    steps:
    - uses: actions/checkout@v3

    - name: Install dependencies
      run: npm ci

    - name: Start app
      run: npm run dev &

    - name: Install Playwright
      run: npm i -D @playwright/test

    - name: Run Playwright tests
      run: npx playwright test --reporter=list
